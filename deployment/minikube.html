


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../_static/favicon.ico">
    
    
      
        <title>MiniKube - Flux Operator</title>
      
    
    
      
        
        
      
      

    
    
    
      
        
        
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
        <link rel="stylesheet" type="text/css" href="../_static/sphinx_immaterial_theme.fa3fbbd75cfdd7cef.min.css" />
        <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
        <link rel="stylesheet" type="text/css" href="../_static/css/rtd_sphinx_search.min.css" />
        <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    


<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />

<!-- Social: Facebook / Open Graph -->
<title>Flux Operator </title>
<link rel="canonical" href="https://flux-framework.github.io/flux-operator/"/>
<meta property="og:type" content="website">

<meta property="og:url" content="https://flux-framework.github.io/flux-operator/">
<meta property="og:title" content="Flux Operator">
<meta property="og:image" content="https://raw.githubusercontent.com/flux-framework/flux-operator/main/docs/images/flux-operator.png">
<meta property="og:description" content="Flux Operator ">
<meta property="og:site_name" content="Flux Operator">
<meta property="og:locale" content="en_US">

<!-- Social: Twitter -->
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@FluxFramework">
<meta name="twitter:title" content="Flux Framework">
<meta name="twitter:description" content="Flux Operator ">
<meta name="twitter:image" content="https://raw.githubusercontent.com/flux-framework/flux-operator/main/docs/images/flux-operator.png">

<!-- Social: Google+ / Schema.org  -->
<meta itemprop="name" content="Flux Operator">
<meta itemprop="description" content="Flux Operator ">
<meta itemprop="image" content="https://raw.githubusercontent.com/flux-framework/flux-operator/main/docs/images/flux-operator.png">
<script type="application/ld+json">
  {"@type":"WebSite","headline":"Flux Operator","url":"https://flux-framework.github.io/flux-operator","description":"The Flux Operator creates Flux MiniClusters on Kubernetes ","name":"Flux Operator","@context":"https://schema.org"}
</script>

<style>
.material-symbols-outlined {
  font-variation-settings:
  'FILL' 0,
  'wght' 400,
  'GRAD' 0,
  'opsz' 48
}
.sphx-glr-script-out .highlight pre {
  background-color: #def0ff !important;
}
  </style>




  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="light-blue">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../index.html" title="Flux Operator" class="md-header__button md-logo" aria-label="Flux Operator" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>
    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Flux Operator
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              MiniKube
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="light-blue"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5Z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="light-blue"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9v1Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/flux-framework/flux-operator/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    Flux Operator
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    
  


  <li class="md-tabs__item">
    <a href="../getting_started/index.html" class="md-tabs__link md-tabs__link--active">
      <span class="md-ellipsis">Getting Started</span>
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../getting_started/tutorials/index.html" class="md-tabs__link">
      <span class="md-ellipsis">Tutorials</span>
    </a>
  </li>

      
        
  
  
    
  


  <li class="md-tabs__item">
    <a href="index.html" class="md-tabs__link md-tabs__link--active">
      <span class="md-ellipsis">Deployment</span>
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../about/index.html" class="md-tabs__link">
      <span class="md-ellipsis">About</span>
    </a>
  </li>

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../index.html" title="Flux Operator" class="md-nav__button md-logo" aria-label="Flux Operator" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>
    </a>
    Flux Operator
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/flux-framework/flux-operator/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    Flux Operator
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" type="checkbox" id="__nav_1" checked>
      
      
      
        <label class="md-nav__link" for="__nav_1">
          <span class="md-ellipsis">Getting Started</span>
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Getting Started" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          <span class="md-ellipsis">Getting Started</span>
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting_started/index.html" class="md-nav__link">
        <span title="/getting_started/index.md (reference label)" class="md-ellipsis">User Guide</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../development/index.html" class="md-nav__link">
        <span title="/development/index.md (reference label)" class="md-ellipsis">Development</span>
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_3" type="checkbox" id="__nav_1_3" checked>
      
      
      
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="index.html"><span title="/deployment/index.md (reference label)" class="md-ellipsis">Clouds</span></a>
          
            <label for="__nav_1_3">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Clouds" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_3">
          <span class="md-nav__icon md-icon"></span>
          <span title="/deployment/index.md (reference label)" class="md-ellipsis">Clouds</span>
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          <span title="/deployment/minikube.md (reference label)" class="md-ellipsis">Mini<wbr>Kube</span>
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="#" class="md-nav__link md-nav__link--active">
        <span title="/deployment/minikube.md (reference label)" class="md-ellipsis">Mini<wbr>Kube</span>
      </a>
      
        

<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#external-examples" class="md-nav__link">
    <span title="/deployment/minikube.md#external-examples (reference label)" class="md-ellipsis">External Examples</span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#workflow-with-storage" class="md-nav__link">
    <span title="/deployment/minikube.md#workflow-with-storage (reference label)" class="md-ellipsis">Workflow with Storage</span>
  </a>
  
    <nav class="md-nav" aria-label="Workflow with Storage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cluster" class="md-nav__link">
    <span title="/deployment/minikube.md#cluster (reference label)" class="md-ellipsis">Cluster</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prepare-data" class="md-nav__link">
    <span title="/deployment/minikube.md#prepare-data (reference label)" class="md-ellipsis">Prepare Data</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#containers" class="md-nav__link">
    <span title="/deployment/minikube.md#containers (reference label)" class="md-ellipsis">Containers</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mount-data" class="md-nav__link">
    <span title="/deployment/minikube.md#mount-data (reference label)" class="md-ellipsis">Mount Data</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run-workflow" class="md-nav__link">
    <span title="/deployment/minikube.md#run-workflow (reference label)" class="md-ellipsis">Run Workflow</span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#development-notes" class="md-nav__link">
    <span title="/deployment/minikube.md#development-notes (reference label)" class="md-ellipsis">Development Notes</span>
  </a>
  
    <nav class="md-nav" aria-label="Development Notes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#debugging-containers" class="md-nav__link">
    <span title="/deployment/minikube.md#debugging-containers (reference label)" class="md-ellipsis">Debugging Containers</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cleaning-up" class="md-nav__link">
    <span title="/deployment/minikube.md#cleaning-up (reference label)" class="md-ellipsis">Cleaning up</span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="aws.html" class="md-nav__link">
        <span title="/deployment/aws.md (reference label)" class="md-ellipsis">Amazon Web Services</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="google.html" class="md-nav__link">
        <span title="/deployment/google.md (reference label)" class="md-ellipsis">Google Cloud</span>
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  
  

            
          
        </ul>
      </nav>
    </li>
  
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" checked>
      
      
      
        <label class="md-nav__link" for="__nav_2">
          <span class="md-ellipsis">Tutorials</span>
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Tutorials" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          <span class="md-ellipsis">Tutorials</span>
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting_started/tutorials/index.html" class="md-nav__link">
        <span title="/getting_started/tutorials/index.md (reference label)" class="md-ellipsis">Tutorials</span>
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      
      
        <label class="md-nav__link" for="__nav_3">
          <span class="md-ellipsis">Deployment</span>
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Deployment" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          <span class="md-ellipsis">Deployment</span>
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1" type="checkbox" id="__nav_3_1" checked>
      
      
      
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="index.html"><span title="/deployment/index.md (reference label)" class="md-ellipsis">Clouds</span></a>
          
            <label for="__nav_3_1">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Clouds" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_1">
          <span class="md-nav__icon md-icon"></span>
          <span title="/deployment/index.md (reference label)" class="md-ellipsis">Clouds</span>
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
    
  
    
    <li class="md-nav__item md-nav__item--active md-nav__current-nested md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_1" type="checkbox" id="__nav_3_1_1" checked>
      
      
      
        
        <div class="md-nav__link md-nav__link--index md-nav__link--active">
          <a href="#"><span title="/deployment/minikube.md (reference label)" class="md-ellipsis">Mini<wbr>Kube</span></a>
          
            <label for="__nav_3_1_1">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="MiniKube" data-md-level="3">
        <label class="md-nav__title" for="__nav_3_1_1">
          <span class="md-nav__icon md-icon"></span>
          <span title="/deployment/minikube.md (reference label)" class="md-ellipsis">Mini<wbr>Kube</span>
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="#external-examples" class="md-nav__link">
        <span title="/deployment/minikube.md#external-examples (reference label)" class="md-ellipsis">External Examples</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_3_1_1_2" type="checkbox" id="__nav_3_1_1_2" checked>
      
      
      
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="#workflow-with-storage"><span title="/deployment/minikube.md#workflow-with-storage (reference label)" class="md-ellipsis">Workflow with Storage</span></a>
          
            <label for="__nav_3_1_1_2">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Workflow with Storage" data-md-level="4">
        <label class="md-nav__title" for="__nav_3_1_1_2">
          <span class="md-nav__icon md-icon"></span>
          <span title="/deployment/minikube.md#workflow-with-storage (reference label)" class="md-ellipsis">Workflow with Storage</span>
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="#cluster" class="md-nav__link">
        <span title="/deployment/minikube.md#cluster (reference label)" class="md-ellipsis">Cluster</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="#prepare-data" class="md-nav__link">
        <span title="/deployment/minikube.md#prepare-data (reference label)" class="md-ellipsis">Prepare Data</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="#containers" class="md-nav__link">
        <span title="/deployment/minikube.md#containers (reference label)" class="md-ellipsis">Containers</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="#mount-data" class="md-nav__link">
        <span title="/deployment/minikube.md#mount-data (reference label)" class="md-ellipsis">Mount Data</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="#run-workflow" class="md-nav__link">
        <span title="/deployment/minikube.md#run-workflow (reference label)" class="md-ellipsis">Run Workflow</span>
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_3_1_1_3" type="checkbox" id="__nav_3_1_1_3" checked>
      
      
      
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="#development-notes"><span title="/deployment/minikube.md#development-notes (reference label)" class="md-ellipsis">Development Notes</span></a>
          
            <label for="__nav_3_1_1_3">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Development Notes" data-md-level="4">
        <label class="md-nav__title" for="__nav_3_1_1_3">
          <span class="md-nav__icon md-icon"></span>
          <span title="/deployment/minikube.md#development-notes (reference label)" class="md-ellipsis">Development Notes</span>
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="#debugging-containers" class="md-nav__link">
        <span title="/deployment/minikube.md#debugging-containers (reference label)" class="md-ellipsis">Debugging Containers</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="#cleaning-up" class="md-nav__link">
        <span title="/deployment/minikube.md#cleaning-up (reference label)" class="md-ellipsis">Cleaning up</span>
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  
  

            
          
        </ul>
      </nav>
    </li>
  
  
      
    <li class="md-nav__item md-nav__item--active md-nav__current-toc">
      
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          <span title="/deployment/minikube.md (reference label)" class="md-ellipsis">Mini<wbr>Kube</span>
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="#" class="md-nav__link md-nav__link--active">
        <span title="/deployment/minikube.md (reference label)" class="md-ellipsis">Mini<wbr>Kube</span>
      </a>
      
        

<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#external-examples" class="md-nav__link">
    <span title="/deployment/minikube.md#external-examples (reference label)" class="md-ellipsis">External Examples</span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#workflow-with-storage" class="md-nav__link">
    <span title="/deployment/minikube.md#workflow-with-storage (reference label)" class="md-ellipsis">Workflow with Storage</span>
  </a>
  
    <nav class="md-nav" aria-label="Workflow with Storage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cluster" class="md-nav__link">
    <span title="/deployment/minikube.md#cluster (reference label)" class="md-ellipsis">Cluster</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prepare-data" class="md-nav__link">
    <span title="/deployment/minikube.md#prepare-data (reference label)" class="md-ellipsis">Prepare Data</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#containers" class="md-nav__link">
    <span title="/deployment/minikube.md#containers (reference label)" class="md-ellipsis">Containers</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mount-data" class="md-nav__link">
    <span title="/deployment/minikube.md#mount-data (reference label)" class="md-ellipsis">Mount Data</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run-workflow" class="md-nav__link">
    <span title="/deployment/minikube.md#run-workflow (reference label)" class="md-ellipsis">Run Workflow</span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#development-notes" class="md-nav__link">
    <span title="/deployment/minikube.md#development-notes (reference label)" class="md-ellipsis">Development Notes</span>
  </a>
  
    <nav class="md-nav" aria-label="Development Notes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#debugging-containers" class="md-nav__link">
    <span title="/deployment/minikube.md#debugging-containers (reference label)" class="md-ellipsis">Debugging Containers</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cleaning-up" class="md-nav__link">
    <span title="/deployment/minikube.md#cleaning-up (reference label)" class="md-ellipsis">Cleaning up</span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="aws.html" class="md-nav__link">
        <span title="/deployment/aws.md (reference label)" class="md-ellipsis">Amazon Web Services</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="google.html" class="md-nav__link">
        <span title="/deployment/google.md (reference label)" class="md-ellipsis">Google Cloud</span>
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  
  

            
          
        </ul>
      </nav>
    </li>
  
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      
      
        <label class="md-nav__link" for="__nav_4">
          <span class="md-ellipsis">About</span>
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="About" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          <span class="md-ellipsis">About</span>
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../about/index.html" class="md-nav__link">
        <span title="/about/index.md (reference label)" class="md-ellipsis">About the Flux Operator</span>
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset" role="main">
                  


  <a href="https://github.com/flux-framework/flux-operator/blob/main/docs/deployment/minikube.md" title="Edit this page" class="md-content__button md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4v-2m10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1 2.1 2.1Z"/></svg>
  </a>

<h1 id="minikube">MiniKube<a class="headerlink" href="#minikube" title="Permalink to this heading">¶</a></h1>
<p>This small tutorial wall walk through how to run the Flux Operator on MiniKube,
deploying a workflow that requires storage.</p>
<h2 id="external-examples">External Examples<a class="headerlink" href="#external-examples" title="Permalink to this heading">¶</a></h2>
<p>The following (external) example tutorials are available:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/converged-computing/workflows/tree/main/nsdf-materialscience">nsfd-materialscience</a>: to preprocess images - requires private data, but code is public.</p></li>
</ul>
<h2 id="workflow-with-storage">Workflow with Storage<a class="headerlink" href="#workflow-with-storage" title="Permalink to this heading">¶</a></h2>
<p>The example here will use the <a class="reference external" href="https://github.com/flux-framework/flux-operator/tree/main/examples/tests/snakemake">Snakemake workflow</a> that comes alongside the examples! Instead of using data that is
already in the <a class="reference external" href="https://github.com/rse-ops/flux-hpc/tree/main/snakemake/atacseq">base container</a>, we will mount it as a shared volume to demonstrate how that works.</p>
<h3 id="cluster">Cluster<a class="headerlink" href="#cluster" title="Permalink to this heading">¶</a></h3>
<p>Bring up your MiniKube cluster!</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><code>$<span class="w"> </span>minikube<span class="w"> </span>start
</code></pre></div>
</div>
<p>If you are working from the repository, you can install and run the operator via developer commands:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><code>$<span class="w"> </span>make<span class="w"> </span>
$<span class="w"> </span>make<span class="w"> </span>install
$<span class="w"> </span>make<span class="w"> </span>run
</code></pre></div>
</div>
<p>Or external to that, you can install the latest version:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><code>$<span class="w"> </span>wget<span class="w"> </span>https://raw.githubusercontent.com/flux-framework/flux-operator/main/examples/dist/flux-operator.yaml
$<span class="w"> </span>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>flux-operator.yaml
</code></pre></div>
</div>
<h3 id="prepare-data">Prepare Data<a class="headerlink" href="#prepare-data" title="Permalink to this heading">¶</a></h3>
<p>Let’s first clone the required data to our local machine. We are going to bind this to the pods.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><code>$<span class="w"> </span>git<span class="w"> </span>clone<span class="w"> </span>--depth<span class="w"> </span><span class="m">1</span><span class="w"> </span>https://github.com/snakemake/snakemake-tutorial-data<span class="w"> </span>/tmp/workflow
</code></pre></div>
</div>
<p>You’ll want to add the <a class="reference external" href="https://github.com/rse-ops/flux-hpc/blob/main/snakemake/atacseq/Snakefile">Snakefile</a> for your workflow
along with a <a class="reference external" href="https://github.com/rse-ops/flux-hpc/blob/main/snakemake/atacseq/scripts/plot-quals.py">plotting script</a>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><code>$<span class="w"> </span>wget<span class="w"> </span>-O<span class="w"> </span>/tmp/workflow/Snakefile<span class="w"> </span>https://raw.githubusercontent.com/rse-ops/flux-hpc/main/snakemake/atacseq/Snakefile
$<span class="w"> </span>mkdir<span class="w"> </span>-p<span class="w"> </span>/tmp/workflow/scripts
$<span class="w"> </span>wget<span class="w"> </span>-O<span class="w"> </span>/tmp/workflow/scripts/plot-quals.py<span class="w"> </span>https://raw.githubusercontent.com/rse-ops/flux-hpc/main/snakemake/atacseq/scripts/plot-quals.py
</code></pre></div>
</div>
<p>You should have this structure:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><code>$<span class="w"> </span>tree<span class="w"> </span>/tmp/workflow
</code></pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code>$ tree /tmp/workflow/
/tmp/workflow/
├── data
│   ├── genome.fa
│   ├── genome.fa.amb
│   ├── genome.fa.ann
│   ├── genome.fa.bwt
│   ├── genome.fa.fai
│   ├── genome.fa.pac
│   ├── genome.fa.sa
│   └── samples
│       ├── A.fastq
│       ├── B.fastq
│       └── C.fastq
├── Dockerfile
├── environment.yaml
├── README.md
├── scripts
│   └── plot-quals.py
└── Snakefile
</code></pre></div>
</div>
<p>In a real production setting, you would likely have this data in cloud storage somewhere. We are emulating
that for MiniKube with a clone to a temporary directory! Note that to make it easier</p>
<h3 id="containers">Containers<a class="headerlink" href="#containers" title="Permalink to this heading">¶</a></h3>
<p>MiniKube can burp sometimes on pulling large images, so let’s issue a command to it to
pull the container we need via ssh.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><code>$<span class="w"> </span>minikube<span class="w"> </span>ssh<span class="w"> </span>docker<span class="w"> </span>pull<span class="w"> </span>ghcr.io/rse-ops/atacseq:app-latest
</code></pre></div>
</div>
<h3 id="mount-data">Mount Data<a class="headerlink" href="#mount-data" title="Permalink to this heading">¶</a></h3>
<p>The Flux Operator is going to expect to find volumes on the host of a particular storage type.
Since we are early in development, we currently (as the default) define a “hostpath” storage type,
meaning the operator will expect the path to be present on the node where you are running the job.
This means that we need to mount the data on our host into MiniKube (where the cluster is running)
with <code class="docutils literal notranslate"><span class="pre">minikube</span> <span class="pre">mount</span></code>.</p>
<p>Note that in our <a class="reference external" href="https://github.com/flux-framework/flux-operator/tree/main/examples/tests/snakemake/minicluster.yaml">minicluster.yaml</a>
we are defining the volume on the host (inside the MiniKube VM) to be at <code class="docutils literal notranslate"><span class="pre">/tmp/data</span></code> so let’s tell MiniKube to mount our local path there:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><code>minikube<span class="w"> </span>ssh<span class="w"> </span>--<span class="w"> </span>mkdir<span class="w"> </span>-p<span class="w"> </span>/tmp/data

minikube<span class="w"> </span>mount<span class="w"> </span>/tmp/workflow:/tmp/data
</code></pre></div>
</div>
<p>Leave that process running in a window and then open another terminal to interact with the cluster.
If you want to double check the data is in the MiniKube vm:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><code>$<span class="w"> </span>minikube<span class="w"> </span>ssh<span class="w"> </span>--<span class="w"> </span>ls<span class="w"> </span>/tmp/data
</code></pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><code><span class="go">Dockerfile  README.md  Snakefile  data	environment.yaml  scripts</span>
</code></pre></div>
</div>
<h3 id="run-workflow">Run Workflow<a class="headerlink" href="#run-workflow" title="Permalink to this heading">¶</a></h3>
<p>At this point we want to run our Snakemake workflow, which means applying the custom resource definition
for the MiniCluster. Conceptually, this is going to bring up the pods on your MiniCluster nodes,
start a flux instance, run your command of interest, and then clean up. Here we can work from
the <code class="docutils literal notranslate"><span class="pre">examples/tests/snakemake</span></code> directory with the <code class="docutils literal notranslate"><span class="pre">minicluster.yaml</span></code> file:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><code>$<span class="w"> </span>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>minicluster.yaml
minicluster.flux-framework.org/flux-sample<span class="w"> </span>created
</code></pre></div>
</div>
<p>You can see your pods:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><code>$<span class="w"> </span>kubectl<span class="w"> </span>get<span class="w"> </span>-n<span class="w"> </span>flux-operator<span class="w"> </span>pods
NAME<span class="w">                         </span>READY<span class="w">   </span>STATUS<span class="w">      </span>RESTARTS<span class="w">   </span>AGE
flux-sample-0-sk72j<span class="w">          </span><span class="m">1</span>/1<span class="w">     </span>Running<span class="w">     </span><span class="m">0</span><span class="w">          </span>35s
flux-sample-1-6tw4z<span class="w">          </span><span class="m">1</span>/1<span class="w">     </span>Running<span class="w">     </span><span class="m">0</span><span class="w">          </span>35s
flux-sample-cert-generator<span class="w">   </span><span class="m">0</span>/1<span class="w">     </span>Completed<span class="w">   </span><span class="m">0</span><span class="w">          </span>35s
</code></pre></div>
</div>
<p>Keep watching for when the job is finished! You can see logs (and snakemake output) as follows:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><code>$<span class="w"> </span>kubectl<span class="w"> </span>logs<span class="w"> </span>-n<span class="w"> </span>flux-operator<span class="w"> </span>flux-sample-0-pssf6<span class="w"> </span>-f
</code></pre></div>
</div>
<details>
<summary>Snakemake Output in Console</summary>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><code><span class="go">broker.info[0]: quorum-full: quorum-&gt;run 0.420945s</span>
<span class="go">Building DAG of jobs...</span>
<span class="go">Using shell: /usr/bin/bash</span>
<span class="go">Provided cores: 1 (use --cores to define parallelism)</span>
<span class="go">Rules claiming more threads will be scaled down.</span>
<span class="go">Job stats:</span>
<span class="go">job               count    min threads    max threads</span>
<span class="go">--------------  -------  -------------  -------------</span>
<span class="go">all                   1              1              1</span>
<span class="go">bcftools_call         1              1              1</span>
<span class="go">bwa_map               2              1              1</span>
<span class="go">plot_quals            1              1              1</span>
<span class="go">samtools_index        2              1              1</span>
<span class="go">samtools_sort         2              1              1</span>
<span class="go">total                 9              1              1</span>

<span class="go">Select jobs to execute...</span>

<span class="go">[Fri Feb 10 00:59:17 2023]</span>
<span class="go">rule bwa_map:</span>
<span class="go">    input: data/genome.fa, data/samples/A.fastq</span>
<span class="go">    output: mapped_reads/A.bam</span>
<span class="go">    jobid: 4</span>
<span class="go">    reason: Missing output files: mapped_reads/A.bam</span>
<span class="go">    wildcards: sample=A</span>
<span class="go">    resources: tmpdir=/tmp</span>

<span class="go">[Fri Feb 10 00:59:27 2023]</span>
<span class="go">Finished job 4.</span>
<span class="go">1 of 9 steps (11%) done</span>
<span class="go">Select jobs to execute...</span>

<span class="go">[Fri Feb 10 00:59:27 2023]</span>
<span class="go">rule samtools_sort:</span>
<span class="go">    input: mapped_reads/A.bam</span>
<span class="go">    output: sorted_reads/A.bam</span>
<span class="go">    jobid: 3</span>
<span class="go">    reason: Missing output files: sorted_reads/A.bam; Input files updated by another job: mapped_reads/A.bam</span>
<span class="go">    wildcards: sample=A</span>
<span class="go">    resources: tmpdir=/tmp</span>

<span class="go">[Fri Feb 10 00:59:37 2023]</span>
<span class="go">Finished job 3.</span>
<span class="go">2 of 9 steps (22%) done</span>
<span class="go">Select jobs to execute...</span>

<span class="go">[Fri Feb 10 00:59:37 2023]</span>
<span class="go">rule bwa_map:</span>
<span class="go">    input: data/genome.fa, data/samples/B.fastq</span>
<span class="go">    output: mapped_reads/B.bam</span>
<span class="go">    jobid: 6</span>
<span class="go">    reason: Missing output files: mapped_reads/B.bam</span>
<span class="go">    wildcards: sample=B</span>
<span class="go">    resources: tmpdir=/tmp</span>

<span class="go">[Fri Feb 10 00:59:47 2023]</span>
<span class="go">Finished job 6.</span>
<span class="go">3 of 9 steps (33%) done</span>
<span class="go">Select jobs to execute...</span>

<span class="go">[Fri Feb 10 00:59:47 2023]</span>
<span class="go">rule samtools_sort:</span>
<span class="go">    input: mapped_reads/B.bam</span>
<span class="go">    output: sorted_reads/B.bam</span>
<span class="go">    jobid: 5</span>
<span class="go">    reason: Missing output files: sorted_reads/B.bam; Input files updated by another job: mapped_reads/B.bam</span>
<span class="go">    wildcards: sample=B</span>
<span class="go">    resources: tmpdir=/tmp</span>

<span class="go">[Fri Feb 10 00:59:57 2023]</span>
<span class="go">Finished job 5.</span>
<span class="go">4 of 9 steps (44%) done</span>
<span class="go">Select jobs to execute...</span>

<span class="go">[Fri Feb 10 00:59:57 2023]</span>
<span class="go">rule samtools_index:</span>
<span class="go">    input: sorted_reads/A.bam</span>
<span class="go">    output: sorted_reads/A.bam.bai</span>
<span class="go">    jobid: 7</span>
<span class="go">    reason: Missing output files: sorted_reads/A.bam.bai; Input files updated by another job: sorted_reads/A.bam</span>
<span class="go">    wildcards: sample=A</span>
<span class="go">    resources: tmpdir=/tmp</span>
<span class="go">...</span>
</code></pre></div>
</div>
</details>
<p>Keep in mind that when <code class="docutils literal notranslate"><span class="pre">cleanup:</span> <span class="pre">true</span></code> is set, the pods will be cleaned up (with the storage)
when everything is finished, so you won’t be able to access the output log. To access it you
can either stream it as it comes (e.g, flux-cloud supports this) or disable cleanup, and clean
up your volumes yourself after things are finished! When the job is finished, everything should register as completed, and you can clean up like:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><code>$<span class="w"> </span>kubectl<span class="w"> </span>delete<span class="w"> </span>-f<span class="w"> </span>minicluster.yaml
minicluster.flux-framework.org<span class="w"> </span><span class="s2">&quot;flux-sample&quot;</span><span class="w"> </span>deleted
</code></pre></div>
</div>
<p>And then stop minikube and the bound directory and you are good!</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><code>$<span class="w"> </span>minikube<span class="w"> </span>stop
</code></pre></div>
</div>
<p>But we might not actually need to get the logs from the operator! Since our data
directory was bound to our host, we have all the output locally too:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><code><span class="go">/tmp/workflow/</span>
<span class="go">├── calls</span>
<span class="go">│   └── all.vcf</span>
<span class="go">├── data</span>
<span class="go">│   ├── genome.fa</span>
<span class="go">│   ├── genome.fa.amb</span>
<span class="go">│   ├── genome.fa.ann</span>
<span class="go">│   ├── genome.fa.bwt</span>
<span class="go">│   ├── genome.fa.fai</span>
<span class="go">│   ├── genome.fa.pac</span>
<span class="go">│   ├── genome.fa.sa</span>
<span class="go">│   └── samples</span>
<span class="go">│       ├── A.fastq</span>
<span class="go">│       ├── B.fastq</span>
<span class="go">│       └── C.fastq</span>
<span class="go">├── Dockerfile</span>
<span class="go">├── environment.yaml</span>
<span class="go">├── mapped_reads</span>
<span class="go">│   ├── A.bam</span>
<span class="go">│   └── B.bam</span>
<span class="go">├── plots</span>
<span class="go">│   └── quals.svg</span>
<span class="go">├── README.md</span>
<span class="go">├── scripts</span>
<span class="go">│   └── plot-quals.py</span>
<span class="go">├── Snakefile</span>
<span class="go">└── sorted_reads</span>
<span class="go">    ├── A.bam</span>
<span class="go">    ├── A.bam.bai</span>
<span class="go">    ├── B.bam</span>
<span class="go">    └── B.bam.bai</span>
</code></pre></div>
</div>
<p>And snakemake keeps logs in a hidden directory:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><code>$<span class="w"> </span>tree<span class="w"> </span>/tmp/workflow/.snakemake/
/tmp/workflow/.snakemake/
├──<span class="w"> </span>auxiliary
├──<span class="w"> </span>conda
├──<span class="w"> </span>conda-archive
├──<span class="w"> </span>incomplete
├──<span class="w"> </span>locks
├──<span class="w"> </span>log
│<span class="w">   </span>└──<span class="w"> </span><span class="m">2023</span>-02-10T005917.395176.snakemake.log
├──<span class="w"> </span>metadata
│<span class="w">   </span>├──<span class="w"> </span>bWFwcGVkX3JlYWRzL0EuYmFt
│<span class="w">   </span>├──<span class="w"> </span>bWFwcGVkX3JlYWRzL0IuYmFt
│<span class="w">   </span>├──<span class="w"> </span>c29ydGVkX3JlYWRzL0EuYmFt
│<span class="w">   </span>├──<span class="w"> </span><span class="nv">c29ydGVkX3JlYWRzL0EuYmFtLmJhaQ</span><span class="o">==</span>
│<span class="w">   </span>├──<span class="w"> </span>c29ydGVkX3JlYWRzL0IuYmFt
│<span class="w">   </span>├──<span class="w"> </span><span class="nv">c29ydGVkX3JlYWRzL0IuYmFtLmJhaQ</span><span class="o">==</span>
│<span class="w">   </span>├──<span class="w"> </span>cGxvdHMvcXVhbHMuc3Zn
│<span class="w">   </span>└──<span class="w"> </span><span class="nv">Y2FsbHMvYWxsLnZjZg</span><span class="o">==</span>
├──<span class="w"> </span>scripts
│<span class="w">   </span>└──<span class="w"> </span>tmp5ppvd29r.plot-quals.py
├──<span class="w"> </span>shadow
└──<span class="w"> </span>singularity

<span class="m">10</span><span class="w"> </span>directories,<span class="w"> </span><span class="m">10</span><span class="w"> </span>files
</code></pre></div>
</div>
<p>Wicked! This is actually the first “realish” workflow we’ve run with the Flux Operator and local data
(that is public) so this is hugely cool to see!</p>
<h2 id="development-notes">Development Notes<a class="headerlink" href="#development-notes" title="Permalink to this heading">¶</a></h2>
<h3 id="debugging-containers">Debugging Containers<a class="headerlink" href="#debugging-containers" title="Permalink to this heading">¶</a></h3>
<p>If you load a container in your MiniKube cluster and need to debug it, it’s useful to shell into the container already pulled there:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><code>$<span class="w"> </span>minikube<span class="w"> </span>ssh<span class="w"> </span>--<span class="w"> </span>docker<span class="w"> </span>run<span class="w"> </span>-it<span class="w"> </span>--entrypoint<span class="w"> </span>bash<span class="w"> </span>ghcr.io/rse-ops/atacseq:app-latest
</code></pre></div>
</div>
<p>This will avoid the redundant pull to your host!</p>
<h3 id="cleaning-up">Cleaning up<a class="headerlink" href="#cleaning-up" title="Permalink to this heading">¶</a></h3>
<p>If you are testing and need to cleanup between runs, if you don’t finish via the operator (<code class="docutils literal notranslate"><span class="pre">cleanup:</span> <span class="pre">true</span></code>) and need to cleanup
volumes:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>delete<span class="w"> </span>-n<span class="w"> </span>flux-operator<span class="w"> </span>pods<span class="w"> </span>--all<span class="w"> </span>--grace-period<span class="o">=</span><span class="m">0</span><span class="w"> </span>--force
kubectl<span class="w"> </span>delete<span class="w"> </span>-n<span class="w"> </span>flux-operator<span class="w"> </span>pvc<span class="w"> </span>--all<span class="w"> </span>--grace-period<span class="o">=</span><span class="m">0</span><span class="w"> </span>--force
kubectl<span class="w"> </span>delete<span class="w"> </span>-n<span class="w"> </span>flux-operator<span class="w"> </span>pv<span class="w"> </span>--all<span class="w"> </span>--grace-period<span class="o">=</span><span class="m">0</span><span class="w"> </span>--force
kubectl<span class="w"> </span>delete<span class="w"> </span>-n<span class="w"> </span>flux-operator<span class="w"> </span><span class="nb">jobs</span><span class="w"> </span>--all<span class="w"> </span>--grace-period<span class="o">=</span><span class="m">0</span><span class="w"> </span>--force
kubectl<span class="w"> </span>delete<span class="w"> </span>-n<span class="w"> </span>flux-operator<span class="w"> </span>MiniCluster<span class="w"> </span>--all<span class="w"> </span>--grace-period<span class="o">=</span><span class="m">0</span><span class="w"> </span>--force
</code></pre></div>
</div>
<p>That’s technically the set of commands to do all-the-things! However, setting the <code class="docutils literal notranslate"><span class="pre">cleanup:</span> <span class="pre">true</span></code> boolean in
the Operator should handle this for you.</p>


  <hr>
<div class="md-source-file">
  <small>
    
      Last update:
      Feb 25, 2023
    
  </small>
</div>





                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="index.html" class="md-footer__link md-footer__link--prev" aria-label="Previous: Clouds" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Clouds
            </div>
          </div>
        </a>
      
      
        
        <a href="aws.html" class="md-footer__link md-footer__link--next" aria-label="Next: Amazon Web Services" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Amazon Web Services
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  
  
  <div class="md-footer-meta md-typeset">
    
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-footer-copyright__highlight">
        &#169; Copyright 2022, Flux Developers.
        
    </div>
  
    Created using
    <a href="https://www.sphinx-doc.org/" target="_blank" rel="noopener">Sphinx</a>
    5.3.0.
     and
    <a href="https://github.com/jbms/sphinx-immaterial/" target="_blank" rel="noopener">Sphinx-Immaterial</a>
  
</div>
      
        <div class="md-social">
  
    
    
    <a href="https://github.com/flux-framework/flux-operator" target="_blank" rel="noopener" title="Flux Operator on GitHub" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
    <a href="https://flux-framework.org/" target="_blank" rel="noopener" title="Flux Framework" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 2.05c5.05.5 9 4.77 9 9.95 0 1.45-.32 2.83-.88 4.07l-2.62-1.53c.32-.79.5-1.64.5-2.54 0-3.53-2.61-6.43-6-6.92V2.05M12 19c2.21 0 4.17-1 5.45-2.62l2.6 1.53A9.97 9.97 0 0 1 12 22C6.47 22 2 17.5 2 12a9.99 9.99 0 0 1 9-9.95v3.03C7.61 5.57 5 8.47 5 12a7 7 0 0 0 7 7m0-13a6 6 0 0 1 6 6c0 2.97-2.16 5.44-5 5.92v-3.09c1.17-.41 2-1.52 2-2.83a3 3 0 0 0-3-3l-.55.05-1.54-2.67C10.56 6.13 11.26 6 12 6m-6 6c0-1.86.85-3.5 2.18-4.62l1.54 2.67C9.27 10.57 9 11.26 9 12c0 1.31.83 2.42 2 2.83v3.09c-2.84-.48-5-2.95-5-5.92Z"/></svg>
    </a>
  
</div>
      
    </div>
    
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.expand", "navigation.tabs", "toc.integrate", "navigation.sections", "navigation.instant", "header.autohide", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "toc.follow", "toc.sticky", "content.tabs.link", "announce.dismiss"], "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
      
        <script src="../_static/sphinx_immaterial_theme.cea6a0c1d5b0618cf.min.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
        <script src="../_static/js/rtd_sphinx_search.min.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
  </body>
</html>